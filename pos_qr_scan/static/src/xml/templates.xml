<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <t t-name="QrButton">
        <div class='control-button'>
            <i class='fa fa-qrcode' /> QR Scan
        </div>
    </t>

    <t t-name="QrScanPopupWidget">
        <div class="modal-dialog">
            <div class="popup popup-qr_scan">
                <div class="sidebar">
                    <div class="title">
                        <p>QR Scanning</p>
                    </div>
                    <div class="body">
                        <p>Scans:</p>
                        <p></p>

                    </div>
                    <div class="footer-qr">
                        <div class="button cancel">Cancel</div>
                    </div>
                </div>
                <div class="preview-container">
                    <video id="preview" class="video_preview"></video>
                    <script type="text/javascript">
                      let scanner = new Instascan.Scanner({video: document.getElementById('preview')});
                      scanner.addListener('scan', function (content) {
                        console.log(content);
                        var new_scan = document.createElement('a');
                        new_scan.setAttribute("href", content);
                        var par = document.createElement("p");
                        par.innerHTML = content;
                        new_scan.appendChild(par);
                        $('.sidebar > .body').append(new_scan);
                      });
                      Instascan.Camera.getCameras().then(function (cameras) {
                        if (cameras.length > 0) {
                          scanner.start(cameras[0]);
                        } else {
                          console.error('No cameras found.');
                        }
                      }).catch(function (e) {
                        console.error(e);
                      });
                    </script>
                </div>
            </div>
        </div>
    </t>

</templates>
